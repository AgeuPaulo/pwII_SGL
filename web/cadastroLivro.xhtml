<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>SGL: Cadastro de Livros</title>
    </h:head>
    <h:body>
        <ui:composition template="./WEB-INF/template/modelo.xhtml">
            <ui:define name="conteudo">
                <p:panel>
                    <p:growl id="message" showDetail="true" />
                    <h:form>   
                        <p:panel>
                            <br/>
                            <p:fieldset legend="Livro">
                                <b:panelGrid col-spans="2,10"  >
                                    <h:outputText value="Titulo"/>
                                    <b:inputText value="#{livroBean.livro.titulo}"/>
                                    <h:outputText value="Autor(a)"/>
                                    <b:inputText value="#{livroBean.livro.autor}" />
                                    <h:outputText value="Editora:"/>
                                    <b:inputText value="#{livroBean.livro.editora}"/>
                                    <h:outputText value="Data de publicação"/>
                                    <b:dateTimePicker value="#{livroBean.livro.ano}" 
                                                      mode="toggle-icon" 
                                                      showButtonPanel="true" 
                                                      format="DD/MM/YYYY"/>
                                    <h:outputText value="Cidade"/>
                                    <b:inputText value="#{livroBean.livro.cidade}"  />
                                    <p:row>
                                        <h:outputText value="Assunto "/>
                                        <p:commandButton title="Adicionar novo" onclick="PF('cadAssunto').show();" icon="ui-icon-plusthick" type="button" />
                                    </p:row>
                                    <b:selectOneMenu value="#{livroBean.assunto}" converter="generic">
                                        <f:selectItem itemLabel="Selecione" itemValue="#{null}" />
                                        <f:selectItems value="#{assuntoBean.lista}" var="assunto" itemValue="#{assunto}" itemLabel="#{assunto.informacao}" />
                                    </b:selectOneMenu>
                                    <p:row>
                                        <h:outputText value="Tipo "/>
                                        <p:commandButton title="Adicionar novo" onclick="PF('cadTipo').show();" icon="ui-icon-plusthick" type="button" />
                                    </p:row>
                                    <b:selectOneMenu value="#{livroBean.tipo}" converter="generic">
                                        <f:selectItem itemLabel="Selecione" itemValue="#{null}" />
                                        <f:selectItems value="#{tipoBean.lista}" var="tipo" itemValue="#{assunto}" itemLabel="#{tipo.tipo}" />
                                    </b:selectOneMenu>
                                    <h:outputText value="Resumo"/>
                                    <b:inputTextarea value="#{livroBean.livro.resumo}" />
                                </b:panelGrid>
                            </p:fieldset>
                            <br/>
                            <b:panelGrid columns="1">
                                <b:commandButton action="#{livroBean.salvarLivro()}" value="Confirmar" look="success" />
                            </b:panelGrid>
                        </p:panel>
                    </h:form>
                    <h:form>
                        <p:dialog header="Cadastrar novo assunto" widgetVar="cadAssunto" minHeight="40">
                            <b:panelGrid col-spans="2,10">
                                <h:outputText value="Informação"/>
                                <b:inputText value="#{assuntoBean.assunto.informacao}" size="50"/>
                                <h:outputText value="Observação"/>
                                <b:inputTextarea value="#{assuntoBean.assunto.observacao}" />
                                <b:panelGrid columns="1">
                                    <b:commandButton action="#{assuntoBean.salvarAssunto()}"  value="Salvar" look="success" />
                                </b:panelGrid>
                            </b:panelGrid>
                        </p:dialog>
                    </h:form>
                    <h:form>       
                        <p:growl id="message" showDetail="true" />
                        <p:dialog header="Cadastrar novo tipo" widgetVar="cadTipo" minHeight="40">
                            <b:panelGrid col-spans="2,10">
                                <h:outputText value="Tipo"/>
                                <b:inputText value="#{tipoBean.tipo.tipo}" size="50"/>
                                <h:outputText value="Descrição"/>
                                <b:inputTextarea value="#{tipoBean.tipo.descricao}" />
                                <b:panelGrid columns="1">
                                    <b:commandButton action="#{tipoBean.salvarTipo()}"  value="Salvar" look="success" />
                                </b:panelGrid>
                            </b:panelGrid>
                        </p:dialog>
                    </h:form>
                    <br/>
                    <h:form id="formulario">
                        <p:dataTable id="tabela" value="#{livroBean.lista}" var="lista"
                                     emptyMessage="Lista vazia." paginator="true" rows="10">
                            <f:facet name="header">
                                Lista de Livros
                            </f:facet>
                            <p:column headerText="ID" style="text-align: center">
                                <h:outputText value="#{lista.idLivro}" />
                            </p:column>
                            <p:column headerText="Titulo" style="text-align: center; width: 25%;">
                                <h:outputText value="#{lista.titulo}" />
                            </p:column>
                            <p:column headerText="Autor" style="text-align: center; width: 15%;">
                                <h:outputText value="#{lista.autor}" />
                            </p:column>
                            <p:column headerText="Editora" style="text-align: center">
                                <h:outputText value="#{lista.editora}" />
                            </p:column>
                            <p:column headerText="Ano" style="text-align: center">
                                <h:outputText value="#{lista.ano}">
                                    <f:convertDateTime pattern="yyyy" />
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Tipo" style="text-align: center">
                                <h:outputText value="#{lista.idTipo.tipo}" />
                            </p:column>
                            <p:column headerText="Assunto" style="text-align: center; width: 15%;">
                                <h:outputText value="#{lista.idAssunto.informacao}" />
                            </p:column>
                            <p:column  headerText="Ação" style="text-align: center">
                                <h:form>
                                    <p:commandButton action="#{livroBean.excluirLivro()}" 
                                                     icon="ui-icon-trash" 
                                                     title="Remover"
                                                     process="@form" update=":formulario:tabela">                          
                                        <f:setPropertyActionListener value="#{lista}" target="#{livroBean.livro}" />
                                    </p:commandButton>
                                    <p:commandButton title="Visualizar" onclick="PF('viewLivro').show();" icon="ui-icon-document" type="button" >
                                        <f:setPropertyActionListener value="#{lista}" target="#{livroBean.livro}" />
                                    </p:commandButton>
                                    <p:dialog header="Visualizar Livro" widgetVar="viewLivro" width="800" height="450" minHeight="40">
                                        <p:panel>
                                            <p:panelGrid style="margin-top:20px;">
                                                <f:facet name="header">
                                                    <p:row>
                                                        <p:column colspan="10">Dados do Livro</p:column>
                                                    </p:row>
                                                </f:facet>
                                                <p:row>
                                                    <p:column colspan="10" styleClass="ui-widget-header">
                                                        <p align="center">Descrição</p>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Titulo</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.titulo}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Autor(es)</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.autor}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="2" style="font-weight: bold;">Editora</p:column>
                                                    <p:column colspan="4">
                                                        <h:outputText value="#{lista.editora}" />
                                                    </p:column>
                                                    <p:column colspan="2" style="font-weight: bold;">Ano</p:column>
                                                    <p:column colspan="2">
                                                        <h:outputText value="#{lista.ano}">
                                                            <f:convertDateTime pattern="yyyy" />
                                                        </h:outputText>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Cidade</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.cidade}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" styleClass="ui-widget-header">
                                                        <p align="center">Resumo</p>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" >
                                                        <h:outputText value="#{lista.resumo}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" styleClass="ui-widget-header">
                                                        <p align="center">Assunto</p>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Informação</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.idAssunto.informacao}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Observação</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.idAssunto.observacao}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" styleClass="ui-widget-header">
                                                        <p align="center">Tipo</p>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Tipo</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.idTipo.tipo}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="4" style="font-weight: bold;">Descrição</p:column>
                                                    <p:column colspan="6">
                                                        <h:outputText value="#{lista.idTipo.descricao}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" styleClass="ui-widget-header">
                                                        <p:spacer height="0"/>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column colspan="10" style="text-align: center;" >Sistema Gerenciador de Livros <br/> Unit - © Ageu Paulo - 2018</p:column>
                                                </p:row>
                                            </p:panelGrid>
                                        </p:panel>
                                    </p:dialog>
                                </h:form>
                            </p:column>
                        </p:dataTable>
                    </h:form>  
                </p:panel>
            </ui:define>
        </ui:composition>
    </h:body>
</html>
